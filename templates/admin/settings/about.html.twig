{% extends 'admin/base.html.twig' %}

{% block title %}Управление на страница "За нас"{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('admin-about') }}
    <style>
        .image-preview {
            position: relative;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .image-preview img {
            max-height: 150px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        
        .image-preview img:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .delete-image {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            line-height: 0;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .delete-image:hover {
            opacity: 1;
        }
        
        .team-member-img {
            max-height: 150px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdn.ckeditor.com/ckeditor5/40.1.0/classic/ckeditor.js"></script>
    {{ encore_entry_script_tags('admin-about') }}
    <script>
        // Функция за изтриване на снимката на компанията
        function deleteCompanyImage(button) {
            if (confirm('Сигурни ли сте, че искате да изтриете тази снимка?')) {
                const preview = button.closest('.image-preview');
                const hiddenInput = document.getElementById('delete_company_image');
                
                // Маркираме снимката за изтриване
                hiddenInput.value = '1';
                
                // Визуализираме изтриването
                preview.style.opacity = '0.3';
                button.disabled = true;
                
                // Показваме съобщение
                const message = document.createElement('div');
                message.className = 'alert alert-warning mt-2';
                message.innerHTML = '<small>Снимката ще бъде изтрита след запазване на промените.</small>';
                preview.parentNode.appendChild(message);
            }
        }
        
        // Функция за изтриване на снимка на член от екипа
        function deleteTeamMemberImage(button, memberIndex) {
            if (confirm('Сигурни ли сте, че искате да изтриете тази снимка?')) {
                const preview = button.closest('.image-preview');
                const hiddenInput = document.getElementById(`delete_team_image_${memberIndex}`);
                
                // Маркираме снимката за изтриване
                hiddenInput.value = '1';
                
                // Визуализираме изтриването
                preview.style.opacity = '0.3';
                button.disabled = true;
                
                // Показваме съобщение
                const message = document.createElement('div');
                message.className = 'alert alert-warning mt-2';
                message.innerHTML = '<small>Снимката ще бъде изтрита след запазване на промените.</small>';
                preview.parentNode.appendChild(message);
            }
        }
        
        // Функция за добавяне на нов член на екипа
        function addTeamMember(lang) {
            const container = document.getElementById(`team-${lang}-container`);
            const cards = container.querySelectorAll('.team-member-card');
            const newKey = cards.length;
            
            const langLabels = {
                'bg': { name: 'Име (BG)', position: 'Позиция (BG)', member: 'Член' },
                'en': { name: 'Name (EN)', position: 'Position (EN)', member: 'Member' },
                'de': { name: 'Name (DE)', position: 'Position (DE)', member: 'Mitglied' },
                'ru': { name: 'Имя (RU)', position: 'Должность (RU)', member: 'Участник' }
            };
            
            const labels = langLabels[lang];
            
            const newCard = document.createElement('div');
            newCard.className = 'card mb-3 team-member-card';
            newCard.setAttribute('data-lang', lang);
            newCard.setAttribute('data-key', newKey);
            
            newCard.innerHTML = `
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="card-title mb-0">${labels.member} ${newKey + 1}</h6>
                        <button type="button" class="btn btn-danger btn-sm" onclick="removeTeamMember(this)">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">${labels.name}</label>
                        <input type="text" class="form-control" 
                               name="team_${lang}[${newKey}][name]" 
                               value="">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">${labels.position}</label>
                        <input type="text" class="form-control" 
                               name="team_${lang}[${newKey}][position]" 
                               value="">
                    </div>
                </div>
            `;
            
            container.appendChild(newCard);
        }
        
        // Функция за премахване на член от екипа
        function removeTeamMember(button) {
            if (confirm('Сигурни ли сте, че искате да премахнете този член от екипа?')) {
                const card = button.closest('.team-member-card');
                card.remove();
                
                // Преномерираме останалите членове
                const lang = card.getAttribute('data-lang');
                const container = document.getElementById(`team-${lang}-container`);
                const cards = container.querySelectorAll('.team-member-card');
                
                cards.forEach((card, index) => {
                    card.setAttribute('data-key', index);
                    const title = card.querySelector('.card-title');
                    const langLabels = {
                        'bg': 'Член',
                        'en': 'Member', 
                        'de': 'Mitglied',
                        'ru': 'Участник'
                    };
                    title.textContent = `${langLabels[lang]} ${index + 1}`;
                    
                    // Обновяваме name атрибутите на полетата
                    const inputs = card.querySelectorAll('input');
                    inputs.forEach(input => {
                        const name = input.getAttribute('name');
                        const newName = name.replace(/\[\d+\]/, `[${index}]`);
                        input.setAttribute('name', newName);
                    });
                });
            }
        }
    </script>
{% endblock %}

{% block body %}
<div class="container-fluid py-4">
    <div class="about-form">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3 mb-0">Управление на страница "За нас"</h1>
        </div>

        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endfor %}

        <form method="post" action="{{ path('admin_about_save') }}" enctype="multipart/form-data">
            <!-- Съдържание на различни езици -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="bi bi-translate"></i> Съдържание
                </h4>
                
                <ul class="nav nav-tabs mb-4" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#bg">
                            <i class="bi bi-globe"></i> Български
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#en">
                            <i class="bi bi-globe"></i> English
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#de">
                            <i class="bi bi-globe"></i> Deutsch
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#ru">
                            <i class="bi bi-globe"></i> Русский
                        </a>
                    </li>
                </ul>

                <div class="tab-content">
                    <!-- Български -->
                    <div class="tab-pane fade show active" id="bg">
                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-type-h1"></i> Заглавна секция
                            </h5>
                            <div class="mb-3">
                                <label for="title_bg" class="form-label">Заглавие (BG)</label>
                                <input type="text" class="form-control" id="title_bg" name="title_bg" 
                                       value="{{ settings.title_bg }}">
                            </div>
                            <div class="mb-3">
                                <label for="subtitle_bg" class="form-label">Подзаглавие (BG)</label>
                                <input type="text" class="form-control" id="subtitle_bg" name="subtitle_bg" 
                                       value="{{ settings.subtitle_bg }}">
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-file-text"></i> История
                            </h5>
                            <div class="mb-3">
                                <label for="content_bg" class="form-label">Съдържание (BG)</label>
                                <textarea class="form-control ckeditor" id="content_bg" name="content_bg" 
                                          rows="10">{{ settings.content_bg }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-star"></i> Ценности
                            </h5>
                            <!-- Quality -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Качество</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_bg[quality][title]" 
                                               value="{{ settings.values_bg.quality.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_bg[quality][description]" 
                                                  rows="2">{{ settings.values_bg.quality.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Development -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Развитие</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_bg[development][title]" 
                                               value="{{ settings.values_bg.development.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_bg[development][description]" 
                                                  rows="2">{{ settings.values_bg.development.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Reliability -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Надеждност</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_bg[reliability][title]" 
                                               value="{{ settings.values_bg.reliability.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_bg[reliability][description]" 
                                                  rows="2">{{ settings.values_bg.reliability.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-search"></i> Meta данни
                            </h5>
                            <div class="mb-3">
                                <label for="meta_title_bg" class="form-label">Meta заглавие (BG)</label>
                                <input type="text" class="form-control" id="meta_title_bg" name="meta_title_bg" 
                                       value="{{ settings.meta_title_bg }}">
                            </div>
                            <div class="mb-3">
                                <label for="meta_description_bg" class="form-label">Meta описание (BG)</label>
                                <textarea class="form-control" id="meta_description_bg" name="meta_description_bg" 
                                          rows="2">{{ settings.meta_description_bg }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-people"></i> Екип (BG)
                            </h5>
                            <div class="mb-3">
                                <button type="button" class="btn btn-success btn-sm" onclick="addTeamMember('bg')">
                                    <i class="bi bi-plus"></i> Добави член на екипа
                                </button>
                            </div>
                            <div id="team-bg-container">
                            {% for key, member in settings.team_bg %}
                                <div class="card mb-3 team-member-card" data-lang="bg" data-key="{{ key }}">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="card-title mb-0">Член {{ key + 1 }}</h6>
                                            <button type="button" class="btn btn-danger btn-sm" onclick="removeTeamMember(this)">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Име (BG)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_bg[{{ key }}][name]" 
                                                   value="{{ member.name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Позиция (BG)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_bg[{{ key }}][position]" 
                                                   value="{{ member.position }}">
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- English -->
                    <div class="tab-pane fade" id="en">
                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-type-h1"></i> Header Section
                            </h5>
                            <div class="mb-3">
                                <label for="title_en" class="form-label">Title (EN)</label>
                                <input type="text" class="form-control" id="title_en" name="title_en" 
                                       value="{{ settings.title_en }}">
                            </div>
                            <div class="mb-3">
                                <label for="subtitle_en" class="form-label">Subtitle (EN)</label>
                                <input type="text" class="form-control" id="subtitle_en" name="subtitle_en" 
                                       value="{{ settings.subtitle_en }}">
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-file-text"></i> History
                            </h5>
                            <div class="mb-3">
                                <label for="content_en" class="form-label">Content (EN)</label>
                                <textarea class="form-control ckeditor" id="content_en" name="content_en" 
                                          rows="10">{{ settings.content_en }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-star"></i> Values
                            </h5>
                            <!-- Quality -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Quality</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Title</label>
                                        <input type="text" class="form-control" 
                                               name="values_en[quality][title]" 
                                               value="{{ settings.values_en.quality.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" 
                                                  name="values_en[quality][description]" 
                                                  rows="2">{{ settings.values_en.quality.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Development -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Development</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Title</label>
                                        <input type="text" class="form-control" 
                                               name="values_en[development][title]" 
                                               value="{{ settings.values_en.development.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" 
                                                  name="values_en[development][description]" 
                                                  rows="2">{{ settings.values_en.development.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Reliability -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Reliability</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Title</label>
                                        <input type="text" class="form-control" 
                                               name="values_en[reliability][title]" 
                                               value="{{ settings.values_en.reliability.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" 
                                                  name="values_en[reliability][description]" 
                                                  rows="2">{{ settings.values_en.reliability.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-search"></i> Meta Data
                            </h5>
                            <div class="mb-3">
                                <label for="meta_title_en" class="form-label">Meta title (EN)</label>
                                <input type="text" class="form-control" id="meta_title_en" name="meta_title_en" 
                                       value="{{ settings.meta_title_en }}">
                            </div>
                            <div class="mb-3">
                                <label for="meta_description_en" class="form-label">Meta description (EN)</label>
                                <textarea class="form-control" id="meta_description_en" name="meta_description_en" 
                                          rows="2">{{ settings.meta_description_en }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-people"></i> Team (EN)
                            </h5>
                            <div class="mb-3">
                                <button type="button" class="btn btn-success btn-sm" onclick="addTeamMember('en')">
                                    <i class="bi bi-plus"></i> Add Team Member
                                </button>
                            </div>
                            <div id="team-en-container">
                            {% for key, member in settings.team_en %}
                                <div class="card mb-3 team-member-card" data-lang="en" data-key="{{ key }}">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="card-title mb-0">Member {{ key + 1 }}</h6>
                                            <button type="button" class="btn btn-danger btn-sm" onclick="removeTeamMember(this)">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Name (EN)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_en[{{ key }}][name]" 
                                                   value="{{ member.name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Position (EN)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_en[{{ key }}][position]" 
                                                   value="{{ member.position }}">
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Deutsch -->
                    <div class="tab-pane fade" id="de">
                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-type-h1"></i> Kopfzeile
                            </h5>
                            <div class="mb-3">
                                <label for="title_de" class="form-label">Titel (DE)</label>
                                <input type="text" class="form-control" id="title_de" name="title_de" 
                                       value="{{ settings.title_de }}">
                            </div>
                            <div class="mb-3">
                                <label for="subtitle_de" class="form-label">Untertitel (DE)</label>
                                <input type="text" class="form-control" id="subtitle_de" name="subtitle_de" 
                                       value="{{ settings.subtitle_de }}">
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-file-text"></i> Geschichte
                            </h5>
                            <div class="mb-3">
                                <label for="content_de" class="form-label">Inhalt (DE)</label>
                                <textarea class="form-control ckeditor" id="content_de" name="content_de" 
                                          rows="10">{{ settings.content_de }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-star"></i> Werte
                            </h5>
                            <!-- Quality -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Qualität</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Titel</label>
                                        <input type="text" class="form-control" 
                                               name="values_de[quality][title]" 
                                               value="{{ settings.values_de.quality.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Beschreibung</label>
                                        <textarea class="form-control" 
                                                  name="values_de[quality][description]" 
                                                  rows="2">{{ settings.values_de.quality.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Development -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Entwicklung</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Titel</label>
                                        <input type="text" class="form-control" 
                                               name="values_de[development][title]" 
                                               value="{{ settings.values_de.development.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Beschreibung</label>
                                        <textarea class="form-control" 
                                                  name="values_de[development][description]" 
                                                  rows="2">{{ settings.values_de.development.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Reliability -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Zuverlässigkeit</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Titel</label>
                                        <input type="text" class="form-control" 
                                               name="values_de[reliability][title]" 
                                               value="{{ settings.values_de.reliability.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Beschreibung</label>
                                        <textarea class="form-control" 
                                                  name="values_de[reliability][description]" 
                                                  rows="2">{{ settings.values_de.reliability.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-people"></i> Team (DE)
                            </h5>
                            <div class="mb-3">
                                <button type="button" class="btn btn-success btn-sm" onclick="addTeamMember('de')">
                                    <i class="bi bi-plus"></i> Teammitglied hinzufügen
                                </button>
                            </div>
                            <div id="team-de-container">
                            {% for key, member in settings.team_de %}
                                <div class="card mb-3 team-member-card" data-lang="de" data-key="{{ key }}">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="card-title mb-0">Mitglied {{ key + 1 }}</h6>
                                            <button type="button" class="btn btn-danger btn-sm" onclick="removeTeamMember(this)">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Name (DE)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_de[{{ key }}][name]" 
                                                   value="{{ member.name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Position (DE)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_de[{{ key }}][position]" 
                                                   value="{{ member.position }}">
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-search"></i> Meta Daten
                            </h5>
                            <div class="mb-3">
                                <label for="meta_title_de" class="form-label">Meta Titel (DE)</label>
                                <input type="text" class="form-control" id="meta_title_de" name="meta_title_de" 
                                       value="{{ settings.meta_title_de }}">
                            </div>
                            <div class="mb-3">
                                <label for="meta_description_de" class="form-label">Meta Beschreibung (DE)</label>
                                <textarea class="form-control" id="meta_description_de" name="meta_description_de" 
                                          rows="2">{{ settings.meta_description_de }}</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Русский -->
                    <div class="tab-pane fade" id="ru">
                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-type-h1"></i> Заголовок
                            </h5>
                            <div class="mb-3">
                                <label for="title_ru" class="form-label">Заглавие (RU)</label>
                                <input type="text" class="form-control" id="title_ru" name="title_ru" 
                                       value="{{ settings.title_ru }}">
                            </div>
                            <div class="mb-3">
                                <label for="subtitle_ru" class="form-label">Подзаголовок (RU)</label>
                                <input type="text" class="form-control" id="subtitle_ru" name="subtitle_ru" 
                                       value="{{ settings.subtitle_ru }}">
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-file-text"></i> История
                            </h5>
                            <div class="mb-3">
                                <label for="content_ru" class="form-label">Содержание (RU)</label>
                                <textarea class="form-control ckeditor" id="content_ru" name="content_ru" 
                                          rows="10">{{ settings.content_ru }}</textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-star"></i> Ценности
                            </h5>
                            <!-- Quality -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Качество</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_ru[quality][title]" 
                                               value="{{ settings.values_ru.quality.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_ru[quality][description]" 
                                                  rows="2">{{ settings.values_ru.quality.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Development -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Развитие</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_ru[development][title]" 
                                               value="{{ settings.values_ru.development.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_ru[development][description]" 
                                                  rows="2">{{ settings.values_ru.development.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                            <!-- Reliability -->
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">Надежность</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Заглавие</label>
                                        <input type="text" class="form-control" 
                                               name="values_ru[reliability][title]" 
                                               value="{{ settings.values_ru.reliability.title ?? '' }}">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Описание</label>
                                        <textarea class="form-control" 
                                                  name="values_ru[reliability][description]" 
                                                  rows="2">{{ settings.values_ru.reliability.description ?? '' }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-people"></i> Команда (RU)
                            </h5>
                            <div class="mb-3">
                                <button type="button" class="btn btn-success btn-sm" onclick="addTeamMember('ru')">
                                    <i class="bi bi-plus"></i> Добавить участника команды
                                </button>
                            </div>
                            <div id="team-ru-container">
                            {% for key, member in settings.team_ru %}
                                <div class="card mb-3 team-member-card" data-lang="ru" data-key="{{ key }}">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="card-title mb-0">Участник {{ key + 1 }}</h6>
                                            <button type="button" class="btn btn-danger btn-sm" onclick="removeTeamMember(this)">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Имя (RU)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_ru[{{ key }}][name]" 
                                                   value="{{ member.name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Должность (RU)</label>
                                            <input type="text" class="form-control" 
                                                   name="team_ru[{{ key }}][position]" 
                                                   value="{{ member.position }}">
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            </div>
                        </div>

                        <div class="form-section">
                            <h5 class="form-section-title">
                                <i class="bi bi-search"></i> Мета данни
                            </h5>
                            <div class="mb-3">
                                <label for="meta_title_ru" class="form-label">Мета заголовок (RU)</label>
                                <input type="text" class="form-control" id="meta_title_ru" name="meta_title_ru" 
                                       value="{{ settings.meta_title_ru }}">
                            </div>
                            <div class="mb-3">
                                <label for="meta_description_ru" class="form-label">Мета описание (RU)</label>
                                <textarea class="form-control" id="meta_description_ru" name="meta_description_ru" 
                                          rows="2">{{ settings.meta_description_ru }}</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Снимки -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="bi bi-image"></i> Снимки
                </h4>
                <div class="mb-3">
                    <label for="company_image" class="form-label">Снимка на компанията</label>
                    <div class="image-upload-container">
                        {% if settings.company_image %}
                            <div class="image-preview">
                                <img src="{{ asset(settings.company_image) }}" alt="Company Image" class="img-thumbnail">
                                <button type="button" class="btn delete-image" onclick="deleteCompanyImage(this)" title="Изтрий снимката">
                                    <i class="bi bi-trash"></i>
                                </button>
                                <input type="hidden" name="delete_company_image" value="0" id="delete_company_image">
                            </div>
                        {% endif %}
                        <input type="file" class="form-control mt-2" id="company_image" name="company_image" accept="image/*">
                    </div>
                </div>
            </div>

            <!-- Снимки на екипа -->
            <div class="form-section">
                <h4 class="form-section-title">
                    <i class="bi bi-camera"></i> Снимки на екипа
                </h4>
                <p class="text-muted mb-3">Снимките се споделят между всички езици. Редактирайте имената и позициите в съответните езикови табове по-горе.</p>
                
                {% for key, common in settings.team_common %}
                    {% set bgMember = settings.team_bg[key] ?? {} %}
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-8">
                                    <h6 class="card-title">
                                        {{ bgMember.name ?? 'Член ' ~ (key + 1) }}
                                        {% if bgMember.position %}
                                            <small class="text-muted">- {{ bgMember.position }}</small>
                                        {% endif %}
                                    </h6>
                                </div>
                                <div class="col-md-4">
                                    <div class="image-upload-container">
                                        {% if common.image is defined and common.image %}
                                            <div class="image-preview">
                                                <img src="{{ asset(common.image) }}" alt="{{ bgMember.name ?? 'Team member' }}" class="img-thumbnail">
                                                <button type="button" class="btn delete-image" onclick="deleteTeamMemberImage(this, {{ key }})" title="Изтрий снимката">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                                <input type="hidden" name="delete_team_image[{{ key }}]" value="0" id="delete_team_image_{{ key }}">
                                            </div>
                                        {% else %}
                                            <img src="{{ asset('/uploads/about/team/default-avatar.jpg') }}" alt="{{ bgMember.name ?? 'Team member' }}" class="team-member-img mb-3">
                                        {% endif %}
                                        <input type="file" class="form-control mt-2" name="team_images[{{ key }}]" accept="image/*">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- Бутони -->
            <div class="d-flex justify-content-end gap-2 mb-4">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-lg"></i> Запази промените
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}