{% extends 'base.html.twig' %}

{% block title %}Контакти{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.1/mapsjs-ui.css" />
    <style>
        /* Contact Page Styles following Industrial Properties Design System */
        .contact-hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: white;
            padding: 8rem 0 6rem;
            position: relative;
            overflow: hidden;
            margin-top: 76px;
        }
        
        .contact-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(rgba(15, 23, 42, 0.8), rgba(51, 65, 85, 0.6));
            z-index: 1;
        }
        
        .contact-hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(255, 255, 255, 0.02) 2px,
                rgba(255, 255, 255, 0.02) 4px
            );
            pointer-events: none;
            z-index: 1;
        }
        
        .contact-hero .container {
            position: relative;
            z-index: 2;
        }
        
        .contact-hero h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 200;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            letter-spacing: -0.02em;
        }
        
        .contact-hero .lead {
            font-size: 1.25rem;
            font-weight: 300;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .content-section {
            padding: 5rem 0;
        }
        
        .content-section.bg-light {
            background: #f8fafc;
            position: relative;
        }
        
        .content-section.bg-light::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #1976d2, transparent);
        }
        
        .contact-info-card {
            background: white;
            border-radius: 20px;
            padding: 3rem 2rem;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 1px solid #e2e8f0;
            position: relative;
            overflow: hidden;
            height: 100%;
        }
        
        .contact-info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .contact-info-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
        }
        
        .contact-info-card:hover::before {
            left: 100%;
        }
        
        .contact-info-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #1e293b, #334155);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            color: white;
            font-size: 2rem;
            transition: all 0.4s ease;
        }
        
        .contact-info-card:hover .contact-info-icon {
            transform: scale(1.2) rotate(5deg);
            background: linear-gradient(135deg, #3b82f6, #1976d2);
        }
        
        .contact-info-card h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 1rem;
        }
        
        .contact-info-card p {
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 0;
        }
        
        .contact-form-card {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        .contact-form-card h2 {
            font-size: 2rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
        }
        
        .contact-form-card h2::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #1976d2, #ff6b35);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .form-control {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-control::placeholder {
            color: #9ca3af;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #3b82f6, #1976d2);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            border: none;
            cursor: pointer;
            transition: all 0.4s ease;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.3);
        }
        
        .submit-btn:hover::before {
            left: 100%;
        }
        
        .map-section {
            position: relative;
            overflow: hidden;
        }
        
        #home-contact-map {
            width: 100%;
            height: 500px;
            border-radius: 0;
        }
        
        .map-overlay {
            position: absolute;
            top: 2rem;
            left: 2rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 300px;
        }
        
        .map-overlay h5 {
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 1rem;
        }
        
        .map-overlay p {
            color: #64748b;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        /* Alert styling */
        .alert {
            border-radius: 12px;
            border: none;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
            border-left: 4px solid #10b981;
        }
        
        .alert-danger {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            border-left: 4px solid #ef4444;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .contact-hero {
                padding: 6rem 0 4rem;
            }
            
            .contact-hero h1 {
                font-size: 2.5rem;
            }
            
            .content-section {
                padding: 3rem 0;
            }
            
            .contact-info-card,
            .contact-form-card {
                margin-bottom: 2rem;
                padding: 2rem 1.5rem;
            }
            
            .map-overlay {
                position: static;
                margin: 1rem;
                margin-bottom: 0;
            }
            
            #home-contact-map {
                height: 400px;
            }
        }
    </style>
{% endblock %}

{% block body %}
    <!-- Hero Section -->
    <section class="contact-hero">
        <div class="container">
            <div class="text-center">
                <h1>Свържете се с нас</h1>
                <p class="lead">Ние сме тук, за да отговорим на всички ваши въпроси</p>
            </div>
        </div>
    </section>

    <!-- Contact Info -->
    <section class="content-section">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4 col-md-6">
                    <div class="contact-info-card">
                        <div class="contact-info-icon">
                            <i class="bi bi-geo-alt"></i>
                        </div>
                        <h4>Адрес</h4>
                        <p>ул. Примерна 123<br>София 1000, България</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="contact-info-card">
                        <div class="contact-info-icon">
                            <i class="bi bi-telephone"></i>
                        </div>
                        <h4>Телефон</h4>
                        <p>+359 2 123 4567<br>+359 888 123 456</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="contact-info-card">
                        <div class="contact-info-icon">
                            <i class="bi bi-envelope"></i>
                        </div>
                        <h4>Имейл</h4>
                        <p>office@industrial-properties.bg<br>info@industrial-properties.bg</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Form -->
{#<section class="content-section bg-light">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="contact-form-card">
                        <h2>Изпратете ни съобщение</h2>
                        
                        {% for label, messages in app.flashes %}
                            {% for message in messages %}
                                <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                </div>
                            {% endfor %}
                        {% endfor %}

                        <form method="post">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="name" class="form-label">Име</label>
                                        <input type="text" class="form-control" id="name" name="name" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="email" class="form-label">Имейл</label>
                                        <input type="email" class="form-control" id="email" name="email" required>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label for="subject" class="form-label">Относно</label>
                                        <input type="text" class="form-control" id="subject" name="subject" required>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label for="message" class="form-label">Съобщение</label>
                                        <textarea class="form-control" id="message" name="message" rows="5" required></textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="submit-btn">Изпрати съобщение</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>#}

    <!-- Map -->
    <section class="map-section">
        <div class="map-overlay d-none d-md-block">
            <h5>Намерете ни</h5>
            <p><strong>Адрес:</strong> ул. Примерна 123, София</p>
            <p><strong>Телефон:</strong> +359 2 123 4567</p>
            <p><strong>Работно време:</strong> Пон-Пет 9:00-18:00</p>
        </div>
        <div id="home-contact-map"></div>
    </section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://js.api.here.com/v3/3.1/mapsjs-core.js"></script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-service.js"></script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-ui.js"></script>
    <script src="https://js.api.here.com/v3/3.1/mapsjs-mapevents.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализиране на Here Maps
            (function initializeHomeContactMap() {
                try {
                    // Създаваме Here Maps платформа с API ключа
                    const apiKey = "{{ app.request.server.get('HERE_MAPS_API_KEY')|default('hPqhtsSWJaVWUUI1vQRnmRvDBlP23bj3Mu-GbOc') }}";
                    
                    const platform = new H.service.Platform({
                        apiKey: apiKey
                    });
                    
                    // Създаваме слоеве
                    const defaultLayers = platform.createDefaultLayers();
                    
                    // Координати на София
                    const sofiaCoordinates = {
                        lat: 42.697797,
                        lng: 23.321661
                    };
                    
                    // Създаваме картата
                    const map = new H.Map(
                        document.getElementById('home-contact-map'),
                        defaultLayers.vector.normal.map,
                        {
                            center: sofiaCoordinates,
                            zoom: 10
                        }
                    );
                    
                    // Добавяме интерактивност и контроли
                    const ui = H.ui.UI.createDefault(map, defaultLayers);
                    const behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
                    
                    // Добавяме маркер за офиса
                    const marker = new H.map.Marker(sofiaCoordinates);
                    
                    // Създаваме балон с информация за офиса - по-компактен
                    marker.setData(`
                        <div style="padding: 8px; min-width: 180px; max-width: 220px;">
                            <h5 style="font-size: 14px; margin-bottom: 5px;">Industrial Properties</h5>
                            <p style="margin-bottom: 5px; font-size: 12px;">ул. Примерна 123<br>София 1000</p>
                            <p style="margin-bottom: 3px; font-size: 12px;"><strong>{{ 'contact.phone'|trans }}:</strong> +359 2 123 4567</p>
                            <p style="margin-bottom: 0; font-size: 12px;"><strong>{{ 'contact.email'|trans }}:</strong> office@industrial-properties.bg</p>
                        </div>
                    `);
                    
                    // Добавяме маркера към картата
                    map.addObject(marker);
                    
                    // Центрираме картата малко по-надолу, за да има място за балона
                    map.setCenter({lat: sofiaCoordinates.lat - 0.001, lng: sofiaCoordinates.lng});
                    
                    // Добавяме слушател за клик върху маркера
                    marker.addEventListener('tap', function(evt) {
                        const bubble = new H.ui.InfoBubble(
                            evt.target.getGeometry(), 
                            { 
                                content: evt.target.getData(),
                                pixelOffset: {x: 0, y: -50}
                            }
                        );
                        ui.addBubble(bubble);
                    });
                    
                    // Отваряме балона автоматично
                    setTimeout(function() {
                        const bubble = new H.ui.InfoBubble(
                            marker.getGeometry(), 
                            { 
                                content: marker.getData(),
                                pixelOffset: {x: 0, y: -50}
                            }
                        );
                        ui.addBubble(bubble);
                    }, 1000);
                    
                    // Ресайз на картата при промяна на размера на прозореца
                    window.addEventListener('resize', () => {
                        map.getViewPort().resize();
                    });
                } catch (error) {
                    console.error('Грешка при инициализиране на Here Maps:', error);
                    document.getElementById('home-contact-map').innerHTML = '<div class="alert alert-danger">Грешка при зареждане на картата</div>';
                }
            })();
        });
    </script>
{% endblock %} 