{% extends 'base.html.twig' %}

{% block title %}{{ 'faq.title'|trans }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    {{ encore_entry_link_tags('faq-index') }}
{% endblock %}

{% block body %}
    <!-- Hero Section -->
    <section class="faq-hero">
        <div class="container">
            <div class="section-header">
                <h1>{{ 'faq.title'|trans }}</h1>
                <p>{{ 'faq.subtitle'|trans }}</p>
            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="faq-categories">
        <div class="container">
            <nav class="nav nav-pills">
                <a class="nav-link {% if not currentCategory %}active{% endif %}" 
                   href="{{ path('app_faq_index') }}">
                    {{ 'faq.categories.all'|trans }}
                </a>
                {% for key, label in categories %}
                    <a class="nav-link {% if currentCategory == key %}active{% endif %}" 
                       href="{{ path('app_faq_index', {'category': key}) }}">
                        {{ label|trans }}
                    </a>
                {% endfor %}
            </nav>
        </div>
    </section>

    <!-- FAQ Content -->
    <section class="faq-content">
        <div class="container">
            <div class="accordion faq-accordion" id="faqAccordion">
                {% for faq in faqs %}
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" 
                                    type="button" 
                                    data-bs-toggle="collapse" 
                                    data-bs-target="#faq{{ faq.id }}"
                                    aria-expanded="false"
                                    aria-controls="faq{{ faq.id }}">
                                {{ faq.question(app.request.locale) }}
                                <span class="category-badge">
                                    {{ categories[faq.category]|trans }}
                                </span>
                            </button>
                        </h2>
                        <div id="faq{{ faq.id }}" 
                             class="accordion-collapse collapse" 
                             data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                {{ faq.answer(app.request.locale)|raw }}
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="faq-no-results">
                        <div class="no-results-icon">
                            <i class="bi bi-question-circle"></i>
                        </div>
                        <h3>{{ 'faq.search.no_results'|trans }}</h3>
                        <p>{{ 'faq.search.no_results_text'|trans }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('faq-index') }}
    
    <!-- FAQ Schema for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {% for faq in faqs %}
            {
                "@type": "Question",
                "name": "{{ faq.question(app.request.locale)|e('js') }}",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "{{ faq.answer(app.request.locale)|striptags|e('js') }}"
                }
            }{% if not loop.last %},{% endif %}
            {% endfor %}
        ]
    }
    </script>
{% endblock %}